

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Event stream Processing &mdash; Project March Melodic documentation</title>
  

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'Melodic',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="High level overview" href="../using_the_march_exoskeleton/high_level_overview.html" />
    <link rel="prev" title="SMACH" href="smach.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/create_your_workspace.html">Create your workspace</a></li>
</ul>
<p class="caption"><span class="caption-text">Useful tools</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="robot_model.html">Robot model</a></li>
<li class="toctree-l1"><a class="reference internal" href="ros_control.html">ros_control</a></li>
<li class="toctree-l1"><a class="reference internal" href="rqt.html">RQT</a></li>
<li class="toctree-l1"><a class="reference internal" href="ros_bag.html">ROS bag</a></li>
<li class="toctree-l1"><a class="reference internal" href="gazebo.html">Gazebo</a></li>
<li class="toctree-l1"><a class="reference internal" href="smach.html">SMACH</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Event stream Processing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-does-sas-esp-work">How does SAS ESP work?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#window-types">Window types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output">Output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#launching-with-esp">Launching with <cite>ESP</cite></a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Using the March Exoskeleton</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/high_level_overview.html">High level overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/connecting_to_the_exoskeleton.html">Connecting to the exoskeleton</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/how_to_airgait.html">How to airgait</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/how_to_view_live_data.html">How to view live data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/log_files.html">Log files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/using_the_gait_generator.html">Using the gait generator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/error_codes.html">Error Codes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using_the_march_exoskeleton/using_the_pressure_soles.html">Using the pressure soles</a></li>
</ul>
<p class="caption"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/documentation.html">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../continuous_integration/continuous_integration.html">Continuous Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/style_guide.html">Style Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/add_a_new_gait.html">Add a new gait</a></li>
</ul>
<p class="caption"><span class="caption-text">March Packages</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_data_collector.html">march_data_collector</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_description.html">march_description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_fake_sensor_data.html">march_fake_sensor_data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_gait_files.html">march_gait_files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_hardware.html">march_hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_hardware_builder.html">march_hardware_builder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_hardware_interface.html">march_hardware_interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_imu_manager.html">march_imu_manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_input_device.html">march_input_device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_launch.html">march_launch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_rqt_input_device.html">march_rqt_input_device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_rqt_software_check.html">march_rqt_software_check</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_safety.html">march_safety</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_shared_classes.html">march_shared_classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_shared_resources.html">march_shared_resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_state_machine.html">march_state_machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_gait_selection.html">march_gait_selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../march_packages/march_simulation.html">march_simulation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Project March</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Event stream Processing</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/project-march/tutorials/blob/master/doc/useful_tools/event_stream_processing.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="event-stream-processing">
<span id="event-stream-processing-label"></span><h1>Event stream Processing<a class="headerlink" href="#event-stream-processing" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>At March we use the <cite>Event Stream Processing</cite> engine from <a class="reference external" href="https://www.sas.com/nl_nl/home.html">SAS</a>.
There is a lot of documentation on this engine at
<a class="reference external" href="https://documentation.sas.com/?cdcId=espcdc&amp;cdcVersion=6.2&amp;docsetId=espov&amp;docsetTarget=home.htm&amp;locale=nl">ESP documentation</a>.
The engine allows for real-time data analysis and processing.</p>
</div>
<div class="section" id="how-does-sas-esp-work">
<h2>How does SAS ESP work?<a class="headerlink" href="#how-does-sas-esp-work" title="Permalink to this headline">¶</a></h2>
<p>An ESP engine runs on a server, at March this is the exoskeleton. The engine can run multiple models.
A model is description of how data should be processed. <a class="reference external" href="https://github.com/project-march/march/tree/develop/march_data_collector/esp_models/march.xml">This</a> is the current model used by March.
A model consists of multiple windows, which together form an acyclic graph.
There are many kinds of windows, which will be discussed later.
Data comes in at so-called <cite>source windows</cite>. One injection of data into a source window is called an event. A value of an event is called a field.
The other window types take in events coming from other windows (not necessarily source windows) and alter the events or create new events.</p>
<div class="section" id="window-types">
<h3>Window types<a class="headerlink" href="#window-types" title="Permalink to this headline">¶</a></h3>
<p>There is really a broad range of different
<a class="reference external" href="https://documentation.sas.com/?cdcId=espcdc&amp;cdcVersion=6.2&amp;docsetId=espcreatewindows&amp;docsetTarget=titlepage.htm&amp;locale=nl">windows</a>.
To get an idea on the kind of actions a window can perform a few are listed here:</p>
<dl class="docutils">
<dt>Join window</dt>
<dd>A join window takes in two event streams and outputs one event stream with fields from both input events.
For instance at March we have a temperature sensor for each joint and a source window for each temperature sensor.
A couple of join windows can put all the temperature values for the different joints in one event.</dd>
<dt>Aggregate windows</dt>
<dd>An aggregate window can calculate summary statistics per group.
A field is selected to group by. The window can then calculate things like maxima, minima, weighted averages or sums of other fields per group.
At March we can use this to get the maximal difference in actual and desired position per gait, if we have an event stream with both the
difference in actual and desired position and the gait name.</dd>
<dt>Compute windows</dt>
<dd>A compute window can do a computation on an event. For instance when you have the actual and desired position
you can compute the difference with a compute window.</dd>
<dt>Calculate windows</dt>
<dd>A calculate window can apply an algorithm to the event it processes.
The <a class="reference external" href="https://documentation.sas.com/?cdcId=espcdc&amp;cdcVersion=6.2&amp;docsetId=espan&amp;docsetTarget=p1iyy8xvfytolsn16djcp243wkx3.htm&amp;locale=nl">list</a>
of possible algorithms is quite long, but to name a few: Streaming Linear Regression, K Nearest Neighbor, Lag Monitoring, Image Processing and Random Forests.</dd>
</dl>
</div>
<div class="section" id="output">
<h3>Output<a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h3>
<p>There is no such thing as an output window in <cite>ESP</cite>. The idea is that you just subscribe to a window of your choosing.
This doesn’t have to be a window at the end of the graph and can even be a source window.
There are a few built-in connectors, but there are also several API’s. The most important subscribe types for March are listed below:</p>
<ul class="simple">
<li>One can add the csv-connector to the model to create a csv of all the events going trough the window.</li>
<li>One can use the Python 3 module <a class="reference external" href="https://github.com/sassoftware/python-esppy">esppy</a>.
Using this with <a class="reference external" href="https://jupyter.org/">Jupyter Lab</a> for instance can give you live information on your model.
This can also be used for live data visualization.</li>
<li>One can also let the March software subscribe to a window.</li>
</ul>
</div>
</div>
<div class="section" id="launching-with-esp">
<h2>Launching with <cite>ESP</cite><a class="headerlink" href="#launching-with-esp" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The ESP engine should be installed on the machine. You need a license for this.
An engine is installed on the exoskeleton.</p>
</div>
<ol class="arabic">
<li><p class="first">Launch an <cite>ESP</cite> server. On the exoskeleton the following terminal command is configured to start an <cite>ESP</cite> with the correct settings.</p>
<blockquote>
<div><div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">esp_start</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Do a normal launch (simulation, headless, normal) and set the launch argument <code class="docutils literal"><span class="pre">esp</span></code> to true. For instance:</p>
<blockquote>
<div><div class="code highlight-default"><div class="highlight"><pre><span></span><span class="n">roslaunch</span> <span class="n">march_launch</span> <span class="n">march</span><span class="o">.</span><span class="n">launch</span> <span class="n">esp</span><span class="p">:</span><span class="o">=</span><span class="n">true</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../using_the_march_exoskeleton/high_level_overview.html" class="btn btn-neutral float-right" title="High level overview" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="smach.html" class="btn btn-neutral float-left" title="SMACH" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Project March
      <span class="lastupdated">
        Last updated on Apr 13, 2020.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>